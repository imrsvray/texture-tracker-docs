<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd"><html>
<head>
  <title>vplibs - header</title>
  <meta name="GENERATOR" content="Quanta Plus">
  <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
</head>
<body>
 <table>
  <tbody>
<tr align="left" valign="top" bgcolor="#ccffff">
<td width="100%">
<table>
  <tbody>
    <tr>
      <td> <a href="/project/vp/vplibs/index.html"><h3> BBC R&amp;D VP
Libraries: </h3></a></td> 
      <td> <a href="/project/vp/vplibs/soGeM/doc/index.html">soGeM</a> |
</td>
      <td> <a 
href="/project/vp/vplibs/VPtexturing/doc/index.html">VPtexturing</a> |
</td>

	<td> <a href="/project/vp/vplibs/VPgeom/doc/index.html">VPgeom</a> |
</td>      
	<td> <a href="/project/vp/vplibs/VPio/doc/index.html">VPio</a> | </td>
	<td> <a href="/project/vp/vplibs/VPip/doc/index.html">VPip</a> | </td>
	<td> <a href="/project/vp/vplibs/VPutil/doc/index.html">VPutil</a> | </td>
        <td> VPai | </td>
      <td> DVSlib | </td>
    </tr>
  </tbody>
</table>
</td>
</tr>
<tr align="left" valign="top" bgcolor="#FFFFFF#ccffff">
<td width="100%">

<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a></div>
<h1>AffineMap.cc</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">* File: AffineMap.cpp</span>
00003 <span class="comment">*</span>
00004 <span class="comment">* Copyright (c) 2004 The British Broadcasting Corporation.</span>
00005 <span class="comment">* &lt;b&gt;ALL RIGHTS RESERVED&lt;/b&gt;.</span>
00006 <span class="comment">*</span>
00007 <span class="comment">* Copyright in the whole and every part of these source files belongs</span>
00008 <span class="comment">* to The British Broadcasting Corporation (BBC) and they</span>
00009 <span class="comment">* may not be used, sold, licenced, transferred, copied or reproduced</span>
00010 <span class="comment">* in whole or in part in any manner or form or in or on any media to</span>
00011 <span class="comment">* any person without the prior written consent of the BBC.</span>
00012 <span class="comment">*/</span>
00013 
00014 <span class="preprocessor">#include "AffineMap.h"</span>
00015 
00016 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00017 <span class="keyword">using</span> <span class="keyword">namespace </span>bbcvp;
00018 
00019 
<a name="l00023"></a><a class="code" href="classbbcvp_1_1AffineMap.html#a0">00023</a> AffineMap::AffineMap()
00024 {
00025         <a class="code" href="classbbcvp_1_1Solve.html">Solve</a> solver;
00026 }
00027 
00028 
<a name="l00032"></a><a class="code" href="classbbcvp_1_1AffineMap.html#a1">00032</a> AffineMap::~AffineMap()
00033 {
00034 
00035 }
00036 
00037 
00038 
<a name="l00039"></a><a class="code" href="classbbcvp_1_1AffineMap.html#a2">00039</a> <span class="keywordtype">int</span> AffineMap::calcMappingCoeffs ( <span class="keywordtype">double</span> *xi, <span class="keywordtype">double</span> *yi, <span class="keywordtype">double</span> *xo, <span class="keywordtype">double</span> *yo, <span class="keywordtype">double</span> *coeffs )
00040 {
00041   <span class="keywordtype">double</span> A[64], B[8];
00042 
00043   <span class="keywordtype">int</span> j=0;  <span class="comment">// pointer to unknown to put in</span>
00044   <span class="keywordtype">int</span> k=0;  <span class="comment">// pointer to right-hand side</span>
00045   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;4; i++)
00046     {
00047       <span class="comment">// equation terms for eqn. based on x output coord:</span>
00048       A[j++] = xi[i];   A[j++] = yi[i];  A[j++] = 1.0;
00049       A[j++] = 0;       A[j++] = 0;      A[j++] = 0;
00050       A[j++] = -xo[i] * xi[i];
00051       A[j++] = -xo[i] * yi[i];
00052       B[k++] = xo[i];      <span class="comment">// minus right-hand side</span>
00053 
00054       <span class="comment">// equation terms for eqn. based on y output coord:</span>
00055       A[j++] = 0;     A[j++] = 0;      A[j++] = 0;
00056       A[j++] = xi[i]; A[j++] = yi[i];  A[j++] = 1.0;
00057       A[j++] = -yo[i] * xi[i];
00058       A[j++] = -yo[i] * yi[i];
00059       B[k++] = yo[i];      <span class="comment">// minus right-hand side</span>
00060 
00061     }
00062 
00063   <span class="comment">// solve Ax-B=0</span>
00064   <span class="keywordtype">int</span> result = solver.<a class="code" href="classbbcvp_1_1Solve.html#a2">solve</a>(A, 8, 8, B, coeffs);
00065 
00066   <span class="keywordflow">if</span> (result != 0)
00067     {
00068       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;8; i++) coeffs[i]=0;
00069       <span class="keywordflow">return</span> (-1);
00070     }
00071   <span class="keywordflow">else</span>
00072     {
00073       <span class="keywordflow">return</span>(0);
00074     }
00075 }
00076 
00077 
00078 
<a name="l00079"></a><a class="code" href="classbbcvp_1_1AffineMap.html#a3">00079</a> <span class="keywordtype">void</span> AffineMap::mapPoint( <span class="keywordtype">double</span> xin, <span class="keywordtype">double</span> yin, <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *xout, <span class="keywordtype">double</span> *yout )
00080 {
00081       *xout = (x[0]*xin + x[1]*yin + x[2]) / (x[6] * xin + x[7] * yin + 1.0);
00082       *yout = (x[3]*xin + x[4]*yin + x[5]) / (x[6] * xin + x[7] * yin + 1.0);
00083 }
00084 
00085 
00086 
</pre></div></td>
</tr>
  </tbody>
</table>
</body>
</html>
