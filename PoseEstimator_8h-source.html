<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd"><html>
<head>
  <title>vplibs - header</title>
  <meta name="GENERATOR" content="Quanta Plus">
  <LINK HREF="doxygen.css" REL="stylesheet" TYPE="text/css">
</head>
<body>
 <table>
  <tbody>
<tr align="left" valign="top" bgcolor="#ccffff">
<td width="100%">
<table>
  <tbody>
    <tr>
      <td> <a href="/project/vp/vplibs/index.html"><h3> BBC R&amp;D VP
Libraries: </h3></a></td> 
      <td> <a href="/project/vp/vplibs/soGeM/doc/index.html">soGeM</a> |
</td>
      <td> <a 
href="/project/vp/vplibs/VPtexturing/doc/index.html">VPtexturing</a> |
</td>

	<td> <a href="/project/vp/vplibs/VPgeom/doc/index.html">VPgeom</a> |
</td>      
	<td> <a href="/project/vp/vplibs/VPio/doc/index.html">VPio</a> | </td>
	<td> <a href="/project/vp/vplibs/VPip/doc/index.html">VPip</a> | </td>
	<td> <a href="/project/vp/vplibs/VPutil/doc/index.html">VPutil</a> | </td>
        <td> VPai | </td>
      <td> DVSlib | </td>
    </tr>
  </tbody>
</table>
</td>
</tr>
<tr align="left" valign="top" bgcolor="#FFFFFF#ccffff">
<td width="100%">

<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a></div>
<h1>PoseEstimator.h</h1><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment"> * File: PoseEstimator.h</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * Copyright (c) 2004 The British Broadcasting Corporation.</span>
00005 <span class="comment"> * &lt;b&gt;ALL RIGHTS RESERVED&lt;/b&gt;.</span>
00006 <span class="comment"> *</span>
00007 <span class="comment"> * Copyright in the whole and every part of these source files belongs</span>
00008 <span class="comment"> * to The British Broadcasting Corporation (BBC) and they</span>
00009 <span class="comment"> * may not be used, sold, licenced, transferred, copied or reproduced</span>
00010 <span class="comment"> * in whole or in part in any manner or form or in or on any media to</span>
00011 <span class="comment"> * any person without the prior written consent of the BBC.</span>
00012 <span class="comment"> */</span>
00013 
00014 
00015 <span class="preprocessor">#ifndef PoseEstimator_h</span>
00016 <span class="preprocessor"></span><span class="preprocessor">#define PoseEstimator_h</span>
00017 <span class="preprocessor"></span>
00018 <span class="keyword">namespace </span>bbcvp {
00019  
00020 
<a name="l00085"></a><a class="code" href="classbbcvp_1_1PoseEstimator.html">00085</a>   <span class="keyword">class </span><a class="code" href="classbbcvp_1_1PoseEstimator.html">PoseEstimator</a> {
00086     
00087   <span class="keyword">public</span>:
00088     
00092 <span class="preprocessor">#define X 0</span>
00093 <span class="preprocessor"></span><span class="preprocessor">#define Y 1</span>
00094 <span class="preprocessor"></span><span class="preprocessor">#define Z 2</span>
00095 <span class="preprocessor"></span>
00097 <span class="preprocessor">#define NPAR_TOT 11  </span><span class="comment">/* total no of cam params */</span>
00098 <span class="preprocessor">#define NPAR_ADJ 7  </span><span class="comment">/* the number that are potenially adjustable */</span>
00099     <span class="comment">/* NB adjustable ones must be listed before non-adjustable ones!! */</span>
00100 <span class="preprocessor">#define CX 0</span>
00101 <span class="preprocessor"></span><span class="preprocessor">#define CY 1</span>
00102 <span class="preprocessor"></span><span class="preprocessor">#define D  2</span>
00103 <span class="preprocessor"></span><span class="preprocessor">#define D1 3</span>
00104 <span class="preprocessor"></span><span class="preprocessor">#define D2 4</span>
00105 <span class="preprocessor"></span><span class="preprocessor">#define D4 5</span>
00106 <span class="preprocessor"></span><span class="preprocessor">#define F  6</span>
00107 <span class="preprocessor"></span><span class="preprocessor">#define XP 7  // first non-adjustable one</span>
00108 <span class="preprocessor"></span><span class="preprocessor">#define YP 8</span>
00109 <span class="preprocessor"></span><span class="preprocessor">#define NX 9</span>
00110 <span class="preprocessor"></span><span class="preprocessor">#define NY 10</span>
00111 <span class="preprocessor"></span>
00135     <a class="code" href="classbbcvp_1_1PoseEstimator.html#a0">PoseEstimator</a>(<span class="keywordtype">int</span> maxPoints=100, <span class="keywordtype">int</span> maxImages=1, <span class="keywordtype">int</span> maxCameras=1, <span class="keywordtype">int</span> maxObjects=1, <span class="keywordtype">int</span> maxLines=0);
00136  
00140     <a class="code" href="classbbcvp_1_1PoseEstimator.html#a1">~PoseEstimator</a>();
00141     
00190     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a2">setCameraData</a>(
00191                        <span class="keywordtype">double</span> **positionCam,
00192                        <span class="keywordtype">double</span> **rotationCam,
00193                        <span class="keywordtype">double</span> **intrinPar,
00194                        <span class="keywordtype">int</span> nCameras=1,
00195                        <span class="keywordtype">bool</span> **adjustPositionCam=(<span class="keywordtype">bool</span>**)0,
00196                        <span class="keywordtype">bool</span> **adjustRotationCam=(<span class="keywordtype">bool</span>**)0,
00197                        <span class="keywordtype">bool</span> **adjustIntrinPar=(<span class="keywordtype">bool</span>**)0);
00198 
00207     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a3">setCameraRange</a>(<span class="keywordtype">int</span> startCam, <span class="keywordtype">int</span> endCam);
00208 
00249     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a4">setObjectData</a>(
00250                        <span class="keywordtype">double</span> ***positionObj,
00251                        <span class="keywordtype">double</span> ***rotationObj,
00252                        <span class="keywordtype">int</span> nObjects=1,
00253                        <span class="keywordtype">bool</span> ***adjustPositionObj=(<span class="keywordtype">bool</span>***)0,
00254                        <span class="keywordtype">bool</span> ***adjustRotationObj=(<span class="keywordtype">bool</span>***)0,
00255                        <span class="keywordtype">int</span> **constrainZAxisYDirObj=(<span class="keywordtype">int</span>**)0);
00256 
00287     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a5">setPointsData</a>(
00288                        <span class="keywordtype">double</span> ****worldPoints,
00289                        <span class="keywordtype">double</span> *****imagePoints,
00290                        <span class="keywordtype">int</span> **nPoints,
00291                        <span class="keywordtype">int</span> nImages=1,
00292                        <span class="keywordtype">bool</span> **useImObj=(<span class="keywordtype">bool</span>**)0,
00293                        <span class="keywordtype">bool</span> ****usePoint=(<span class="keywordtype">bool</span>****)0,
00294                        <span class="keywordtype">double</span> ****weightPoint=(<span class="keywordtype">double</span>****)0);
00329     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a6">setLinesData</a>(
00330         <span class="keywordtype">double</span> *****worldLines,
00331         <span class="keywordtype">double</span> ******imageLines,
00332         <span class="keywordtype">int</span> **nLines,
00333         <span class="keywordtype">int</span> nImages=1,
00334         <span class="keywordtype">bool</span> **useImObj=(<span class="keywordtype">bool</span>**)0,
00335         <span class="keywordtype">bool</span> ****useLine=(<span class="keywordtype">bool</span>****)0,
00336         <span class="keywordtype">double</span> ****weightLine=(<span class="keywordtype">double</span>****)0);
00337 
00345     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a7">setVerticalFOV</a>( <span class="keywordtype">double</span> fovyRad, <span class="keywordtype">int</span> cam=0);
00346 
00354     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a8">setVerticalFOVDeg</a>( <span class="keywordtype">double</span> fovy, <span class="keywordtype">int</span> cam=0);
00355 
00364     <span class="keywordtype">double</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a9">getVerticalFOV</a>(<span class="keywordtype">int</span> cam=0);
00365 
00374     <span class="keywordtype">double</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a10">getVerticalFOVDeg</a>(<span class="keywordtype">int</span> cam=0);
00375 
00384     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a11">setTerminationConditions</a>(
00385                                   <span class="keywordtype">double</span> rmsLimit,
00386                                   <span class="keywordtype">int</span> maxIter,
00387                                   <span class="keywordtype">double</span> limit,
00388                                   <span class="keywordtype">double</span> maxRmsErrorIncrease=0.0);
00389 
<a name="l00396"></a><a class="code" href="classbbcvp_1_1PoseEstimator.html#a12">00396</a>     <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a12">setVerbosity</a>(<span class="keywordtype">int</span> verbosity) { mVerbose = verbosity; }
00397     
00425     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a13">roughEstimateObject</a>(
00426                              <span class="keywordtype">int</span> cam=0,
00427                              <span class="keywordtype">int</span> image=0,
00428                              <span class="keywordtype">int</span> obj=0,
00429                              <span class="keywordtype">double</span> typicalObjectDistance=3.0);
00430     
00461     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a14">roughEstimateCamera</a>(
00462                              <span class="keywordtype">int</span> cam=0,
00463                              <span class="keywordtype">int</span> image=0,
00464                              <span class="keywordtype">int</span> obj=0,
00465                              <span class="keywordtype">double</span> typicalObjectDistance=3.0);
00466     
00482     <span class="keywordtype">double</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a15">calcSolution</a>();
00483 
00567     <span class="keywordtype">double</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a16">calcSolutionRansac</a>(
00568         <span class="keywordtype">double</span> maxInlierDist,
00569         <span class="keywordtype">double</span> minInlierFraction,
00570         <span class="keywordtype">int</span> maxTries,
00571         <span class="keywordtype">bool</span> useInitialGuess,
00572         <span class="keywordtype">int</span> nInitialPoints,
00573         <span class="keywordtype">bool</span> ****inlierPoint,
00574         <span class="keywordtype">int</span> *nFinalPoints = (<span class="keywordtype">int</span> *)0,
00575         <span class="keywordtype">int</span> nInitialLines = 0,
00576         <span class="keywordtype">bool</span> ****inlierLine=(<span class="keywordtype">bool</span>****)0,
00577         <span class="keywordtype">int</span> *nFinalLines = (<span class="keywordtype">int</span> *)0
00578         );
00579 
00623     <span class="keywordtype">double</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a17">calcSolutionWithUnknownObjectRotation</a>(
00624                              <span class="keywordtype">double</span> *rotRange,
00625                              <span class="keywordtype">int</span> *rotNStep,
00626                              <span class="keywordtype">int</span> image=0,
00627                              <span class="keywordtype">int</span> obj=0);
00628     
00629 
00648     <span class="keywordtype">double</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a18">oneIteration</a> ( <span class="keywordtype">double</span> *rmsError);
00649 
00660     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a19">PoseEstimator::calcRelWorldPosArbitraryPoint</a>(
00661                                                       <span class="keywordtype">int</span> cam,
00662                                                       <span class="keywordtype">int</span> image,
00663                                                       <span class="keywordtype">int</span> obj,
00664                                                       <span class="keywordtype">double</span> wx, <span class="keywordtype">double</span> wy, <span class="keywordtype">double</span> wz,
00665                                                       <span class="keywordtype">double</span> *rwx, <span class="keywordtype">double</span> *rwy, <span class="keywordtype">double</span> *rwz);
00666       
00667 
00679     <span class="keywordtype">bool</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a20">calcImagePositionPoint</a>(
00680                            <span class="keywordtype">int</span> cam,
00681                            <span class="keywordtype">int</span> image,
00682                            <span class="keywordtype">int</span> obj,
00683                            <span class="keywordtype">int</span> point,
00684                            <span class="keywordtype">double</span> *xPos,
00685                            <span class="keywordtype">double</span> *yPos);
00686     
00701     <span class="keywordtype">bool</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a21">calcImagePositionArbitraryPoint</a>(
00702                            <span class="keywordtype">int</span> cam,
00703                            <span class="keywordtype">int</span> image,
00704                            <span class="keywordtype">int</span> obj,
00705                            <span class="keywordtype">double</span> wx,
00706                            <span class="keywordtype">double</span> wy,
00707                            <span class="keywordtype">double</span> wz,
00708                            <span class="keywordtype">double</span> *xPos,
00709                            <span class="keywordtype">double</span> *yPos);
00710   
00723     <span class="keywordtype">bool</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a22">calcImagePositionLine</a>(
00724         <span class="keywordtype">int</span> cam,
00725         <span class="keywordtype">int</span> image,
00726         <span class="keywordtype">int</span> obj,
00727         <span class="keywordtype">int</span> line,
00728         <span class="keywordtype">double</span> *xPosStart,
00729         <span class="keywordtype">double</span> *yPosStart,
00730         <span class="keywordtype">double</span> *xPosEnd,
00731         <span class="keywordtype">double</span> *yPosEnd);
00732     
00756     <span class="keywordtype">bool</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a23">calcImagePositionPixelsArbitraryLine</a>(
00757                                               <span class="keywordtype">int</span> cam,
00758                                               <span class="keywordtype">int</span> image,
00759                                               <span class="keywordtype">int</span> obj,
00760                                               <span class="keywordtype">double</span> startWx,
00761                                               <span class="keywordtype">double</span> startWy,
00762                                               <span class="keywordtype">double</span> startWz,
00763                                               <span class="keywordtype">double</span> endWx,
00764                                               <span class="keywordtype">double</span> endWy,
00765                                               <span class="keywordtype">double</span> endWz,
00766                                               <span class="keywordtype">double</span> *startX,
00767                                               <span class="keywordtype">double</span> *startY,
00768                                               <span class="keywordtype">double</span> *endX,
00769                                               <span class="keywordtype">double</span> *endY);
00770 
00789     <span class="keywordtype">bool</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a24">calcImagePositionArbitraryLine</a>(
00790                                         <span class="keywordtype">int</span> cam,
00791                                         <span class="keywordtype">int</span> image,
00792                                         <span class="keywordtype">int</span> obj,
00793                                         <span class="keywordtype">double</span> startWx,
00794                                         <span class="keywordtype">double</span> startWy,
00795                                         <span class="keywordtype">double</span> startWz,
00796                                         <span class="keywordtype">double</span> endWx,
00797                                         <span class="keywordtype">double</span> endWy,
00798                                         <span class="keywordtype">double</span> endWz,
00799                                         <span class="keywordtype">double</span> *startX,
00800                                         <span class="keywordtype">double</span> *startY,
00801                                         <span class="keywordtype">double</span> *endX,
00802                                         <span class="keywordtype">double</span> *endY);
00803     
00834     <span class="keywordtype">bool</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a25">calcImageErrorPoint</a>(
00835                         <span class="keywordtype">int</span> cam,
00836                         <span class="keywordtype">int</span> image,
00837                         <span class="keywordtype">int</span> obj,
00838                         <span class="keywordtype">int</span> point,
00839                         <span class="keywordtype">double</span> *x,
00840                         <span class="keywordtype">double</span> *y);
00841 
00872     <span class="keywordtype">bool</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a26">calcImageErrorLine</a>(
00873                         <span class="keywordtype">int</span> cam,
00874                         <span class="keywordtype">int</span> image,
00875                         <span class="keywordtype">int</span> obj,
00876                         <span class="keywordtype">int</span> line,
00877                         <span class="keywordtype">double</span> *errStart,
00878                         <span class="keywordtype">double</span> *errEnd);
00879 
00909     <span class="keywordtype">int</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a27">calcRMSErrorPoints</a>(
00910                      <span class="keywordtype">double</span> *rmsError,
00911                      <span class="keywordtype">int</span> cam=-1,
00912                      <span class="keywordtype">int</span> image=-1,
00913                      <span class="keywordtype">int</span> object=-1,
00914                      <span class="keywordtype">int</span> point=-1);
00915 
00948     <span class="keywordtype">int</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a28">calcRMSErrorLines</a>(
00949                      <span class="keywordtype">double</span> *rmsError,
00950                      <span class="keywordtype">int</span> cam=-1,
00951                      <span class="keywordtype">int</span> image=-1,
00952                      <span class="keywordtype">int</span> object=-1,
00953                      <span class="keywordtype">int</span> line=-1);
00954 
00974     <span class="keywordtype">int</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a29">calcRMSError</a>(
00975                      <span class="keywordtype">double</span> *rmsError,
00976                      <span class="keywordtype">int</span> cam=-1,
00977                      <span class="keywordtype">int</span> image=-1,
00978                      <span class="keywordtype">int</span> object=-1);
00996     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a30">calcWorldPoints</a>(
00997         <span class="keywordtype">double</span> **worldCoords,
00998         <span class="keywordtype">int</span> image=0,
00999         <span class="keywordtype">int</span> obj=0);
01000 
01021     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a31">calcImagePoints</a>(
01022         <span class="keywordtype">double</span> **imagePoints,
01023         <span class="keywordtype">int</span> cam=0,
01024         <span class="keywordtype">int</span> image=0,
01025         <span class="keywordtype">int</span> obj=0);
01026 
01050     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a32">calcImageLines</a>(
01051         <span class="keywordtype">double</span> ***imageLines,
01052         <span class="keywordtype">int</span> cam=0,
01053         <span class="keywordtype">int</span> image=0,
01054         <span class="keywordtype">int</span> obj=0);
01055 
01072     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a33">calcRotMatObj</a>(
01073                        <span class="keywordtype">int</span> image,
01074                        <span class="keywordtype">int</span> obj,
01075                        <span class="keywordtype">double</span> *rotMat);
01076       
01094     <span class="keywordtype">void</span> <a class="code" href="classbbcvp_1_1PoseEstimator.html#a34">calcRotMatCam</a>(
01095                        <span class="keywordtype">int</span> cam,
01096                        <span class="keywordtype">double</span> *rotMat);
01097       
01098 
01099   <span class="keyword">protected</span>:
01100     <span class="keywordtype">int</span> mVerbose;                  <span class="comment">// 0=no printout, 1=print each iteration, etc.</span>
01101 
01102     <span class="comment">// ---- data about cameras</span>
01103     <span class="keywordtype">int</span> mNCameras;
01104     <span class="keywordtype">int</span> mStartCam;                       <span class="comment">// first camera to process (usually 0)</span>
01105     <span class="keywordtype">int</span> mEndCam;                         <span class="comment">// last camera to process (usually mNCameras-1)</span>
01106     <span class="keywordtype">double</span> **mPositionCam;               <span class="comment">//[cam][X|Y|Z]</span>
01107     <span class="keywordtype">double</span> **mRotationCam;               <span class="comment">//[cam][X|Y|Z]</span>
01108     <span class="keywordtype">double</span> **mIntrinPar;                 <span class="comment">//[cam][F|D|D1|D2|D4|CX|CY|XP|YP]</span>
01109     <span class="keywordtype">bool</span> **mAdjustPositionCam;           <span class="comment">//[cam][X|Y|Z]</span>
01110     <span class="keywordtype">bool</span> **mAdjustRotationCam;           <span class="comment">//[cam][X|Y|Z]</span>
01111     <span class="keywordtype">bool</span> **mAdjustIntrinPar;             <span class="comment">//[cam][F|D|D1|D2|D4|CX|CY|XP|YP]</span>
01112 
01113     <span class="keywordtype">bool</span> mAllCamPosFixed;                <span class="comment">// if true then corresponding Adjust array may well point to NULL</span>
01114     <span class="keywordtype">bool</span> mAllCamRotFixed;                <span class="comment">// (NB to fix only one camera, this must be done by using mAdjustPositionCam array)</span>
01115     <span class="keywordtype">bool</span> mAllCamIntrinFixed;
01116 
01117     <span class="comment">// --- data about objects</span>
01118     <span class="keywordtype">int</span> mNObjects;
01119     <span class="keywordtype">double</span> ***mPositionObj;              <span class="comment">//[image][obj][X|Y|Z]</span>
01120     <span class="keywordtype">double</span> ***mRotationObj;              <span class="comment">//[image][obj][X|Y|Z]</span>
01121     <span class="keywordtype">bool</span> ***mAdjustPositionObj;          <span class="comment">//[image][obj][X|Y|Z]</span>
01122     <span class="keywordtype">bool</span> ***mAdjustRotationObj;          <span class="comment">//[image][obj][X|Y|Z]</span>
01123     <span class="keywordtype">int</span> **mConstrainZAxisYDirObj;         <span class="comment">//[image][obj]</span>
01124 
01125     <span class="keywordtype">bool</span> mAllObjPosFixed;               <span class="comment">// if true then corresponding Adjust array may well point to NULL</span>
01126     <span class="keywordtype">bool</span> mAllObjRotFixed;               <span class="comment">// if true then corresponding Adjust array may well point to NULL</span>
01127     <span class="keywordtype">bool</span> mAllZAxisYDirObjUnconstrained; <span class="comment">// if true then corresponding Constrain array may well point to NULL</span>
01128 
01129 
01130 <span class="comment">// data about visible points &amp; lines, common to both:</span>
01131     <span class="keywordtype">int</span> mNImages;                      <span class="comment">// gives range of "image" index in arrays below</span>
01132     <span class="keywordtype">bool</span> **mUseImObj;                  <span class="comment">//[image][obj]</span>
01133     <span class="keywordtype">bool</span> mUseAllImObj;                 <span class="comment">// if true then corresponding Use array may be NULL</span>
01134 
01135     <span class="comment">// --- data about visible world points</span>
01136     <span class="keywordtype">int</span> **mNPoints;                    <span class="comment">//[image][obj] - gives range of "point" index for use in arrays below</span>
01137     <span class="keywordtype">double</span> ****mWorldPoints;           <span class="comment">//[image][obj][point][X|Y|Z]</span>
01138     <span class="keywordtype">double</span> *****mImagePoints;          <span class="comment">//[cam][image][obj][point][X|Y]</span>
01139     <span class="keywordtype">bool</span> ****mUsePoint;                <span class="comment">//[cam][image][obj][point]</span>
01140     <span class="keywordtype">double</span> ****mWeightPoint;            <span class="comment">//[cam][image][obj][line]</span>
01141     <span class="keywordtype">bool</span> mUseAllPoints;
01142 
01143     <span class="comment">// --- data about visible world lines</span>
01144     <span class="keywordtype">int</span> **mNLines;                    <span class="comment">//[image][obj] - gives range of "point" index for use in arrays below</span>
01145     <span class="keywordtype">double</span> *****mWorldLines;           <span class="comment">//[image][obj][line][start|end][X|Y|Z]</span>
01146     <span class="keywordtype">double</span> ******mImageLines;          <span class="comment">//[cam][image][obj]line][start|end][X|Y]</span>
01147     <span class="keywordtype">bool</span> ****mUseLine;                <span class="comment">//[cam][image][obj][line]</span>
01148     <span class="keywordtype">double</span> ****mWeightLine;           <span class="comment">//[cam][image][obj][line]</span>
01149     <span class="keywordtype">bool</span> mUseAllLines;
01150 
01151 
01152   <span class="keyword">private</span>:
01153 
01154     <span class="keywordtype">void</span> saveParams();     <span class="comment">// saves cam &amp; obj params into temp arrays</span>
01155     <span class="keywordtype">void</span> restoreParams();  <span class="comment">// restores from temp arrays</span>
01156     <span class="keywordtype">int</span> mMaxPoints;
01157     <span class="keywordtype">int</span> mMaxLines;
01158     <span class="keywordtype">int</span> mMaxImages;
01159     <span class="keywordtype">int</span> mMaxCameras;
01160     <span class="keywordtype">int</span> mMaxObjects;
01161 
01162     <span class="comment">// iteration controls:</span>
01163     <span class="keywordtype">double</span> mMaxRmsErrorIncrease;   <span class="comment">// max RMS error increase allowed during iterations</span>
01164     <span class="keywordtype">int</span> mMaxIter;                  <span class="comment">// max number of iterations to perform</span>
01165     <span class="keywordtype">double</span> mLimit;                 <span class="comment">// stop when param adjustment size factor less than this </span>
01166     <span class="keywordtype">double</span> mRmsLimit;              <span class="comment">// stop iterating when rms error changes by less than this </span>
01167 
01168     <span class="keywordtype">int</span> mArrayLengthA;
01169     <span class="keywordtype">int</span> mArrayLengthX;
01170     <span class="keywordtype">int</span> mArrayLengthB;
01171 
01172     <span class="comment">// --- stoarge for working variables: these are allocated as member variables to avoid malloc'ing each time</span>
01173 
01174     <span class="keywordtype">double</span> **mIntrinParOld;           <span class="comment">// intrin_par[MAX_CAMERA][NPAR_TOT] - the camera's intrinsic parameters</span>
01175     <span class="keywordtype">double</span> ***mPositionObjOld;    <span class="comment">// position_obj[image][obj][3] - posn of calib obj origin in each image</span>
01176     <span class="keywordtype">double</span> ***mRotationObjOld;    <span class="comment">// rotation_obj[image][obj][3] - rot of calib obj origin in each image</span>
01177     <span class="keywordtype">double</span> **mRotationCamOld;
01178     <span class="keywordtype">double</span> **mPositionCamOld;
01179     <span class="keywordtype">double</span> **mIntrinParSave;      <span class="comment">// as above - for temp storage - used by calcSolutionWithUnknownObjectRotation</span>
01180     <span class="keywordtype">double</span> ***mPositionObjSave;
01181     <span class="keywordtype">double</span> ***mRotationObjSave;
01182     <span class="keywordtype">double</span> **mRotationCamSave;
01183     <span class="keywordtype">double</span> **mPositionCamSave;
01184     <span class="keywordtype">double</span> **mWorldPointsTemp;    <span class="comment">//mWorldCoords[point][X|Y|Z] - used by initial camera estimator to hold selected</span>
01185                                   <span class="comment">// object's world points converted to world ref frame</span>
01186     <span class="keywordtype">bool</span>**** mInlierPointTemp;    <span class="comment">// [cam][im][obj][point] - holds set of inliers currently being tested in ransac method </span>
01187     <span class="keywordtype">bool</span>**** mInlierLineTemp;     <span class="comment">// [cam][im][obj][point] - holds set of inliers currently being tested in ransac method </span>
01188     <span class="keywordtype">int</span> **mFirstObjUnknown;       <span class="comment">//[im][obj] - gives index to the first unknown for given object in given image</span>
01189     <span class="keywordtype">int</span> *mFirstCamUnknown;        <span class="comment">//[cam] - gives index to the first unknown for given camera</span>
01190 
01191     <span class="keywordtype">double</span> *mArrayA;              <span class="comment">// arrays for simul eqn. solving</span>
01192     <span class="keywordtype">double</span> *mArrayX;
01193     <span class="keywordtype">double</span> *mArrayB;
01194 
01195 
01196   };
01197 
01198 } <span class="comment">// namespace end</span>
01199 
01200 <span class="preprocessor">#endif</span>
01201 <span class="preprocessor"></span>
</pre></div></td>
</tr>
  </tbody>
</table>
</body>
</html>
